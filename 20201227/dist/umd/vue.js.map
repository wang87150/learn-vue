{"version":3,"file":"vue.js","sources":["../../src/util/index.js","../../src/util/mergeOptions.js","../../src/global.js","../../src/compile/parser.js","../../src/compile/generate.js","../../src/compile/index.js","../../src/observe/dep.js","../../src/observe/scheduler.js","../../src/observe/watcher.js","../../src/vdom/patch.js","../../src/lifecycle.js","../../src/utils.js","../../src/observe/array.js","../../src/observe/index.js","../../src/state.js","../../src/initMixin.js","../../src/vdom/index.js","../../src/render.js","../../src/index.js"],"sourcesContent":["let cbs = [];\r\nlet waiting = false;\r\n\r\nfunction timer(cb) {\r\n  Promise.resolve().then(() => {\r\n    cb();\r\n  })\r\n}\r\n\r\nfunction flushCallbacks() {\r\n  cbs.forEach(cb => {\r\n    cb();\r\n  })\r\n  waiting = true;\r\n}\r\n\r\nexport function nextTick(cb, delay = 0) {\r\n  if (typeof cb == 'function') {\r\n    cbs.push(cb);\r\n    if (!waiting) {\r\n      timer(flushCallbacks);\r\n    }\r\n  }\r\n}\r\n\r\nexport function isFunction(val) {\r\n  return typeof val === 'function';\r\n}\r\n\r\nexport function isObject(val) {\r\n  return typeof val == 'object' && val !== null\r\n\r\n}","import {isObject} from './index.js';\r\nfunction mergeHook(first, last) {\r\n\r\n  if (last) {\r\n    if (first) {\r\n      return first.concat(last);\r\n    } else {\r\n      return [last];\r\n    }\r\n  } else {\r\n    return first;\r\n  }\r\n}\r\n\r\nconst tactics = {};\r\nlet lifeCycleHooks = [\r\n  'beforeCreate',\r\n  'created',\r\n  'beforeMount',\r\n  'mounted',\r\n  'beforeUpdate',\r\n  'updated',\r\n  'beforeDestroy',\r\n  'destroyed',\r\n]\r\n\r\nlifeCycleHooks.forEach(lifeCycle => {\r\n  tactics[lifeCycle] = mergeHook;\r\n})\r\n\r\ntactics.components = function(parentV, childV) {\r\n  let options = Object.create(parentV);   //通过原型创建\r\n  if (childV) {\r\n    //如果孩子有值，遍历孩子，将值赋给options\r\n    for (let key in childV) {\r\n      parentV[key] = childV[key];\r\n    }\r\n  }\r\n  return options;\r\n}\r\n\r\nexport default function mergeOption(parent, child) {\r\n  const options = {};\r\n  let parentKeys = Object.keys(parent);\r\n  let childKeys = Object.keys(child);\r\n  parentKeys.forEach(parentKey => {\r\n    mergeField(parentKey);\r\n  })\r\n\r\n  childKeys.forEach(childKey => {\r\n    //如果老的里面已经有这个字段了，则跳过\r\n    if (!parent.hasOwnProperty(childKey)) {\r\n      mergeField(childKey);\r\n    }\r\n  })\r\n\r\n  function mergeField(key) {\r\n    let parentV = parent[key];\r\n    let childV = child[key];\r\n    if (tactics[key]) {\r\n      options[key] = tactics[key](parentV, childV)\r\n    } else {\r\n      if (isObject(parentV) && isObject(childV)) {\r\n        options[key] = {...parentV, ...childV};\r\n      } else {\r\n        //如果新的没值，则直接赋老值 否则直接将新值赋给老值\r\n        options[key] = childV ? childV : parentV;\r\n      }\r\n    }\r\n  }\r\n  return options;\r\n}","import mergeOption from \"./util/mergeOptions\";\r\n\r\nexport function initGlobalMethods(Vue) {\r\n  Vue.options = {};\r\n  Vue.mixin = function(options) {\r\n    this.options = mergeOption(this.options, options)\r\n    return this;\r\n  }\r\n\r\n  //将自身挂载到options的_base属性上，后续每一个组件都能使用this.options._base拿到Vue\r\n  Vue.options._base = Vue;    \r\n  Vue.options.components = {};\r\n\r\n  Vue.component = function(name, define) {\r\n    define = this.options._base.extends(define);\r\n    this.options.components[name] = define;\r\n  }\r\n\r\n  Vue.extends = function(define) {\r\n    const Super = this;\r\n    const Sub = function VueComponent(options) {\r\n      this._init(options);\r\n    }\r\n    Sub.prototype = Object.create(Super.prototype);\r\n    Sub.prototype.constructor = Sub;\r\n    Sub.options = mergeOption(Super.options, define);\r\n    return Sub;\r\n  }\r\n}","const ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; //标签名\r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`;\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 标签开头的正则 捕获的内容是标签名\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // 匹配标签结尾的 </div>\r\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // 匹配属性的\r\nconst startTagClose = /^\\s*(\\/?)>/; // 匹配标签结束的 >\r\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\r\n\r\nexport function parseHtml(html) {\r\n\r\n    function createElement(tagName, attrs) {\r\n        return {\r\n            tag: tagName,\r\n            parent: null,\r\n            children: [],\r\n            attrs,\r\n            type: 1,\r\n            text: ''\r\n        }\r\n    }\r\n\r\n    function parseStartTag() {\r\n        let mMatch = html.match(startTagOpen);\r\n        if (mMatch) {\r\n            //如果是开始标签\r\n            const match = {\r\n                tagName: mMatch[1],\r\n                attrs: []\r\n            }\r\n            //然后截取字符串\r\n            advance(mMatch[0].length);\r\n\r\n            //然后再解析标签属性，\r\n            let attr, end;\r\n            //因为只能解析一个属性，所以需要使用while循环\r\n            while (!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\r\n                //如果标签没有结束且有属性\r\n                match.attrs.push({\r\n                    name: attr[1],\r\n                    value: attr[3] || attr[4] || attr[5]\r\n                })\r\n                advance(attr[0].length);\r\n            }\r\n            if (end) {\r\n                //匹配到结束标签\r\n                advance(end[0].length);\r\n            }\r\n            return match;\r\n        }\r\n    }\r\n\r\n    function advance(length) {\r\n        html = html.substring(length);\r\n    }\r\n\r\n    let stack = [];\r\n    let root = null;\r\n    //开始标签\r\n    function start(tagName, attrs) {\r\n\r\n        let parent = stack[stack.length - 1];\r\n        let element = createElement(tagName, attrs);\r\n        if (!root) {\r\n            root = element;\r\n        }\r\n        if (parent) {\r\n            element.parent = parent;\r\n            parent.children.push(element);\r\n        }\r\n        stack.push(element);\r\n    }\r\n\r\n    function end(tagName) {\r\n        let last = stack.pop();\r\n        if (last.tag !== tagName) {\r\n            throw new Error('标签有误！！！！');\r\n        }\r\n    }\r\n\r\n    function chars(text) {\r\n        text = text.replace(/\\s/g, \"\");\r\n        let element = stack[stack.length - 1];\r\n        if (text) {\r\n            element.children.push({\r\n                type: 3,\r\n                text\r\n            })\r\n        }\r\n    }\r\n\r\n    while (html) {\r\n        let textEnd = html.indexOf('<');\r\n        if (textEnd == 0) {\r\n\r\n            //有可能是开始标签<div>   也有可能是结束标签</div>\r\n            let startTagMatch = parseStartTag();\r\n            if (startTagMatch) {\r\n                //如果是开始标签\r\n                start(startTagMatch.tagName, startTagMatch.attrs);\r\n                continue;\r\n            }\r\n\r\n            let endTagMatch = html.match(endTag);\r\n            if (endTagMatch) {\r\n                advance(endTagMatch[0].length);\r\n                end(endTagMatch[1]);\r\n                continue;\r\n            }\r\n        }\r\n\r\n        let text;\r\n        if (textEnd > 0) {\r\n            text = html.substring(0, textEnd);\r\n        }\r\n        if (text) {\r\n            advance(text.length);\r\n            chars(text);\r\n        }\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n    return root;\r\n}","const defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\r\n\r\nexport function generate(root) {    //_c('div', {id: 'a', attr: 'b'}, _v('Hello'))\r\n    let children = getChildStr(root.children);  //'Hello' + arr + 'World'\r\n    let str = `_c('${root.tag}',${\r\n        root.attrs.length ? getAttrStr(root.attrs) : 'undefined'\r\n    }${\r\n        children ? `,${children}`: ''\r\n    })`;\r\n\r\n    return str;\r\n}\r\n\r\nfunction getChildStr(children) {\r\n    let str = '';\r\n    if (children) {\r\n        return children.map(child => {\r\n            return gen(child);\r\n        }).join(',');\r\n    }\r\n    return false;\r\n}\r\n\r\nfunction gen(child) {\r\n    if (child.type == '1') {\r\n        return generate(child);\r\n    }\r\n    if (child.type == '3') {\r\n        let text = child.text;\r\n        if (!defaultTagRE.test(text)) {\r\n            //匹配不到\r\n            return `_v('${text}')`;\r\n        } else {\r\n            //能匹配到，需要用正则不停的匹配，分割字符串 //'Hello' + arr + 'World'\r\n            let strs = [];\r\n            let match;\r\n\r\n            let lastIndex = defaultTagRE.lastIndex = 0;\r\n            while(match = defaultTagRE.exec(text)) {\r\n                let index = match.index;\r\n                strs.push(JSON.stringify(text.slice(lastIndex, index)));\r\n                lastIndex = index + match[0].length;\r\n                strs.push(`_s(${match[1].trim()})`);\r\n            }\r\n            strs.push(JSON.stringify(text.slice(lastIndex)));\r\n            return `_v(${strs.join('+')})`;\r\n        }\r\n\r\n        \r\n    }\r\n}\r\n\r\nfunction getAttrStr(attrs) {\r\n    let attrsStrs = attrs.map((item) => {\r\n        if (item.name == 'style') {\r\n            let styleObj = {};\r\n            item.value.replace(/([^:;]+)\\:\\s*([^:;]+)/g, function() {\r\n                styleObj[arguments[1]] = arguments[2];\r\n            })\r\n            return `style: ${JSON.stringify(styleObj)}`;\r\n        }\r\n        return `${item.name}:${JSON.stringify(item.value)}`;\r\n    });\r\n    return `{${attrsStrs.join(',')}}`\r\n}","\r\nimport {parseHtml} from './parser.js'\r\nimport {generate} from './generate.js'\r\n\r\n\r\nexport function compileToFunction(template) {\r\n  let ast = parseHtml(template);  //编译模板 生成ast树  \r\n  /**\r\n   * {\r\n   *  tag: 'div',\r\n   *  attrs: [{name: 'id', value: 'app'}, {name: 'style', value: {color: red ; font-size: 12px ;}],\r\n   *  parent: null,\r\n   *  text: '',\r\n   *  type: 1,    //1-节点；3-文本\r\n   *  children: []\r\n   * }\r\n   */\r\n  let code = generate(ast);       //将ast树生成render函数字符串\r\n  /** _c(标签，属性，孩子)\r\n   * _c('div', {id: 'app', :class: 'main', style: {\"color\":\"red \",\" font-size\":\"12px \"}}, \r\n   *  _c('h1', undefine, _v(\"\" + _s(msg) + \"\")))\r\n   */\r\n  let render = new Function(`with(this){return ${code}}`);\r\n  return render;\r\n}","let uid = 0;\r\nclass Dep {\r\n  constructor() {\r\n    this.uid = uid++;\r\n    this.watchers = [];  //收集\r\n  }\r\n  depend() {\r\n    if(Dep.target) {\r\n      Dep.target.addDep(this);  //将dep添加进watcher中\r\n    } else {\r\n      // console.log('没有了');\r\n    }\r\n  }\r\n\r\n  addWatcher(watcher) {\r\n    this.watchers.push(watcher);\r\n  }\r\n  notify() {\r\n    this.watchers.forEach(watcher => {\r\n      watcher.update();\r\n    })\r\n  }\r\n  run() {\r\n    this.watchers.forEach(watcher => {\r\n      watcher.update();\r\n    })\r\n  }\r\n}\r\n\r\nDep.target = null;\r\nconst stack = [];\r\nexport function pushTarget(watcher) {\r\n  Dep.target = watcher;\r\n  stack.push(watcher);\r\n}\r\nexport function popTarget() {\r\n  stack.pop();\r\n  Dep.target = stack[stack.length - 1];\r\n}\r\n\r\nexport default Dep;\r\n","import { nextTick } from \"../util/index.js\";\r\n\r\nlet pending = false;\r\nlet ids = [];\r\nlet queue = [];\r\n\r\nfunction flushSchedule() {\r\n  queue.forEach(watcher => {\r\n    watcher.run();\r\n  })\r\n}\r\n\r\nexport function queueWatchers(watcher) {\r\n  let id = watcher.uid;\r\n  if (!ids.includes(id)) {\r\n    //没有存过这个watcher，将他存起来\r\n    queue.push(watcher);\r\n    ids.push(id);\r\n    if (!pending) {\r\n      nextTick(flushSchedule, 0);\r\n      pending = true;\r\n    }\r\n  }\r\n}","import { popTarget, pushTarget } from \"./dep\";\r\nimport { queueWatchers } from \"./scheduler\";\r\n\r\nlet uid = 0;\r\n\r\nclass Watcher {\r\n  constructor(vm, updateOrFn, afterUpdate, options) {\r\n    this.uid = uid++;\r\n    this.vm = vm;\r\n    this.updateOrFn = updateOrFn;\r\n    this.cb = afterUpdate;\r\n    this.options = options;\r\n    this.user = !!options.user;  //双重否定赋值给user-boolean 类型\r\n    this.lazy = !!options.lazy;  //双重否定赋值给user-boolean 类型\r\n    this.dirty = !!options.lazy;\r\n    if (typeof updateOrFn === 'string') {\r\n      //如果是字符串类型，\r\n      this.getter = function() {\r\n        let names = updateOrFn.split('.');\r\n        return names.reduce((preV, curV) => {\r\n          return preV[curV]\r\n        }, vm);\r\n      }\r\n    } else {\r\n      this.getter = updateOrFn; //执行它 会加载变量数据，到变量的get方法\r\n    }\r\n    \r\n    this.deps = [];       //收集deps，主要是为了计算watcher跟watch使用。\r\n    this.depIds = [];      //手机dep的id，防止重复添加\r\n\r\n    //默认加载一次\r\n    this.value = options.lazy ? undefined : this.get();\r\n  }\r\n\r\n  get() {\r\n    pushTarget(this);//将当前的watcher存放到dep中\r\n    let newValue = this.getter.call(this.vm);\r\n    popTarget();  //取出watcher\r\n    \r\n    return newValue;\r\n  }\r\n\r\n  addDep(dep) {\r\n    let depId = dep.uid;\r\n    if (!this.depIds.includes(depId)) {\r\n      //没有添加过，\r\n      this.deps.push(dep);\r\n      this.depIds.push(depId);\r\n      dep.addWatcher(this);\r\n    }\r\n  }\r\n\r\n  depend() {\r\n    let i = this.deps.length;\r\n    while(i--) {\r\n      let dep = this.deps[i];\r\n      dep.depend();\r\n    }\r\n  }\r\n\r\n  update() {\r\n    //vue中的更新是异步的，等待所有的变量赋值完毕后，一把更新\r\n    //---所以需要先将watcher缓存起来，最后在调用run方法\r\n    if (this.lazy) {\r\n      this.dirty = true;\r\n    } else {\r\n      queueWatchers(this);\r\n    }\r\n    \r\n  }\r\n\r\n  evaluate() {\r\n    this.dirty = false;\r\n    this.value = this.get();\r\n  }\r\n\r\n  run() {\r\n    let newValue = this.get();\r\n    let oldValue = this.value;\r\n    if (this.user) {\r\n      //如果是用户watcher，执行回调\r\n      this.cb.call(this.vm, newValue, oldValue);\r\n    }\r\n    this.value = newValue;\r\n  }\r\n};\r\n\r\nexport default Watcher;","export function patch(oldVnode, vnode) {\r\n  //创建组件的真实dom也会走这里，组件是没有el的属性的 所以这里的oldVnode是空的\r\n  if (!oldVnode) {\r\n    //没有则直接创建真实dom\r\n    return createElement(vnode);\r\n  }\r\n  if (oldVnode.nodeType == '1') {\r\n    //是真实dom，此时需将vnode生成真实dom，然后插入相关位置，再将老的dom删除\r\n    let ele = createElement(vnode);\r\n\r\n    let parentElm = oldVnode.parentNode;\r\n\r\n    parentElm.insertBefore(ele, oldVnode.nextSibling);\r\n\r\n    parentElm.removeChild(oldVnode);\r\n\r\n    return ele;\r\n\r\n  }\r\n}\r\n\r\nfunction createElement(vnode) {\r\n  let {tag, data, text, children, vm} = vnode;\r\n  if (typeof tag == 'string') {\r\n    //是标签，也有可能是组件，这里需要先尝试创建一下组件，看看能不能创建成功\r\n    if (createComponent(vnode)) {\r\n      return vnode.componentInstance.$el;\r\n    }\r\n    vnode.el = document.createElement(tag);\r\n    children.forEach(child => {\r\n      vnode.el.appendChild(createElement(child));\r\n    });\r\n  } else {\r\n    //是文本\r\n    vnode.el = document.createTextNode(text);\r\n  }\r\n  return vnode.el;\r\n}\r\n\r\nfunction createComponent(vnode) {\r\n  let i = vnode.data;\r\n  //看看data属性上是否有hook，且hook上是否有init方法，\r\n  //如果有则执行init方法；init上已经定义过$mount渲染方法了\r\n  if ((i = i.hook) && (i = i.init)) {\r\n    i(vnode);   //$mount方法执行完毕后，会在vm上挂载$el真实节点属性\r\n  }\r\n  if (vnode.componentInstance) {\r\n    // 有属性说明子组件new完毕了，并且组件对应的真实DOM挂载到了componentInstance.$el\r\n    return true;\r\n  }\r\n  return false;\r\n}","import Watcher from \"./observe/watcher\";\r\nimport { patch } from \"./vdom/patch\";\r\n\r\nexport function mountComponent(vm, el) {\r\n  \r\n  //更新函数，后续数据变化 也可以走这个函数\r\n  let updateComponent = () => {\r\n    vm._update(vm._render(vm));   //将生成的虚拟dom 转化成真实dom\r\n  }\r\n\r\n  callHooks(vm, 'beforeMount');\r\n  new Watcher(vm, updateComponent, () => {\r\n    console.log('我更新了');\r\n  }, {});\r\n  callHooks(vm, 'mounted');\r\n}\r\n\r\nexport function lifecycleMixin(Vue) {\r\n  Vue.prototype._update = function(vnode) {\r\n    //既有初始化，也有更新\r\n    let vm = this;\r\n    vm.$el = patch(vm.$el, vnode);\r\n  }\r\n}\r\n\r\nexport function callHooks(vm, hookName) {\r\n  let hookCbs = vm.$options[hookName];\r\n  if (!hookCbs) return;\r\n  hookCbs.forEach(hookCb => {\r\n    hookCb.call(vm);\r\n  })\r\n}","export function isFunction(obj) {\r\n  return typeof obj === 'function';\r\n}\r\n\r\nexport function isObject(obj) {\r\n  return typeof obj === 'object' && obj !== null;\r\n}\r\n\r\nexport function isArray(obj) {\r\n  return Array.isArray(obj);\r\n}\r\n\r\nexport function isReservedTag(tagName) {\r\n  let reservedTag = 'a,div,span,p,img,button,ul,li,h1,h2,h3,h4,h5,h6,table,tr,td';\r\n  return reservedTag.includes(tagName);\r\n}","let oldArrayMethods = Array.prototype;  //原来的数组原型链\r\nexport let arrayMethods = Object.create(oldArrayMethods);\r\n//原理就是arrayMethods__proto__ = Array.prototype;  继承原来array的原型链\r\n\r\nlet methods = [\"push\", \"unshift\", \"slice\", \"pop\", \"shift\", \"sort\", \"reverse\"];\r\n\r\nmethods.forEach((method) => {\r\n  //同时调用原来的原型链方法\r\n  arrayMethods[method] = function (...args) {\r\n    oldArrayMethods[method].call(this, ...args);\r\n\r\n    let ob = this.__ob__;\r\n    let insertItems;\r\n    //对数组中新增的项  继续进行观测\r\n    switch (method) {\r\n      case 'push':\r\n      case 'unshift':\r\n        insertItems = args;\r\n        break;\r\n      case 'splice':\r\n        insertItems = args.slice(2);\r\n        break;\r\n    }\r\n\r\n    if (insertItems) ob.observeArray(insertItems);\r\n\r\n    ob.dep.notify();    //通知watcher更新\r\n  }\r\n})","import { isObject, isArray } from \"../utils\";\r\nimport { arrayMethods } from \"./array\";\r\nimport Dep from \"./dep\";\r\n\r\nexport function observe(data) {\r\n  //如果是对象才观测，否则直接return;\r\n  if(!isObject(data)) return;\r\n  // return new Observe(data);\r\n  if (data.__ob__) return;\r\n  return new Observe(data);\r\n}\r\n\r\nclass Observe {\r\n  constructor(data) {\r\n    this.dep = new Dep();\r\n    data.__ob__ = this;\r\n    Object.defineProperty(data, '__ob__', {\r\n      value: this,\r\n      enumerable: false\r\n    })\r\n    if (isArray(data)) {\r\n      //如果是数组，则对数组中的每一项进行观测，同时重写数组中的变异方法如：push，unShift等（面向切面）\r\n      data.__proto__ = arrayMethods;\r\n      this.observeArray(data);\r\n    } else {\r\n      this.walk(data);\r\n    }\r\n  }\r\n  //观测对象\r\n  walk(data) {\r\n    //对data进行遍历劫持，使用Object.keys 可以避免遍历到原型链上的属性，不必再用hasOwnProperty来进行判断\r\n    Object.keys(data).forEach((key) => {\r\n      defineReactive(data, key, data[key]);\r\n    })\r\n  }\r\n  //遍历观测数组中的每一项\r\n  observeArray(data) {\r\n    data.forEach((item) => {\r\n      observe(item);\r\n    })\r\n  }\r\n}\r\n\r\nfunction dependArray(value) {\r\n  for (let i = 0; i < value.lengrh; i++) {\r\n    let current = value[i];\r\n    current.__ob__ && current.__ob__.dep.depend();\r\n    if (Array.isArray(current)) {\r\n      dependArray(current);\r\n    }\r\n  }\r\n}\r\n\r\nfunction defineReactive(data, key, value) {\r\n  //因为对象的层级可能很深，也就是value也是一个对象，所以需要对value也进行遍历劫持\r\n  let childOb = observe(value);\r\n  const dep = new Dep();\r\n  Object.defineProperty(data, key, {\r\n    get() {\r\n      //取值时，将当前属性对应的watcher存放到属性自己的dep中\r\n      dep.depend();\r\n      if (childOb) {\r\n        childOb.dep.depend();\r\n        if (Array.isArray(value)) {\r\n          dependArray(value);\r\n        }\r\n      }\r\n      return value;\r\n    },\r\n    set(newValue) {\r\n      //因为set的值可能是个对象，也需要对其进行遍历劫持\r\n      if(newValue !== value) {\r\n        observe(newValue);\r\n        value = newValue;\r\n        dep.notify();\r\n      }\r\n    }\r\n  })\r\n}","import Dep from \"./observe/dep\";\r\nimport { observe } from \"./observe/index\";\r\nimport Watcher from \"./observe/watcher\";\r\nimport { isFunction } from \"./utils\";\r\n\r\nexport default function initStates(vm) {\r\n  if (vm.$options.data) initData(vm);  //初始化data属性\r\n  if (vm.$options.computed) initComputed(vm, vm.$options.computed);\r\n  if (vm.$options.watch) initWatch(vm, vm.$options.watch);\r\n}\r\n\r\nfunction proxy(vm, source, key) {\r\n  Object.defineProperty(vm, key, {\r\n    get() {\r\n      return vm[source][key];\r\n    },\r\n    set(newValue) {\r\n      vm[source][key] = newValue;\r\n    }\r\n  })\r\n}\r\n\r\nfunction initData(vm) {\r\n  let data = vm.$options.data;\r\n\r\n  // data = vm._data = isFunction(data) ? data() : data;\r\n  data = vm._data = isFunction(data) ? data.call(vm) : data;\r\n\r\n  //对data的第一层数据进行代理 使得vm.name === vm._data.name;\r\n\r\n  for(let key in data) {\r\n    proxy(vm, '_data', key);\r\n  }\r\n\r\n  //开始观测数据\r\n  observe(data);\r\n}\r\n\r\nfunction initWatch(vm, watchs) {\r\n  let keys = Object.keys(watchs);\r\n  keys.forEach(key => {\r\n    if (Array.isArray(watchs[key])) {\r\n      //如果是数组--watch可以写成数组的形式\r\n      for (let i = 0; i < watchs[key].length; i++) {\r\n        let handler = watchs[key][i];\r\n        createWatch(vm, key, handler);\r\n      }\r\n    } else {\r\n      let handler = watchs[key];\r\n      createWatch(vm, key, handler);\r\n    }\r\n  })\r\n}\r\n\r\nfunction createWatch(vm, name, handler) {\r\n  vm.$watch(name, handler); //需要扩展原型\r\n}\r\n\r\nfunction initComputed(vm, computeds) {\r\n  let keys = Object.keys(computeds);\r\n  const watcherMap = vm._computedWatcherMap = {};\r\n  keys.forEach(key => {\r\n    let userDef = computeds[key]; //用户定义的\r\n    let getter = typeof userDef == 'function' ? userDef : userDef.get;\r\n    let watcher = createComputed(vm, getter, ()=>{}, {lazy: true}); //创建computed\r\n    watcherMap[key] = watcher;\r\n    proxyComputed(vm, key, userDef);    //代理computed的属性到vm上\r\n  })\r\n}\r\n\r\nfunction createComputed(vm, getter, cb, options) {\r\n  return new Watcher(vm, getter, cb, options);\r\n}\r\n\r\nfunction proxyComputed(vm, key, userDef) {\r\n  let shareProperty = {};\r\n  // if (typeof userDef === 'function') {\r\n  //   //如果是函数\r\n  //   shareProperty.get = userDef;\r\n  // } else {\r\n  //   shareProperty.get = createComputedGetter(key);\r\n  // }\r\n  shareProperty.get = createComputedGetter(key);\r\n  Object.defineProperty(vm, key, shareProperty)\r\n}\r\n\r\nfunction createComputedGetter(key) {\r\n  return function computedGetter() {\r\n    let watcher = this._computedWatcherMap[key];\r\n    if (watcher.dirty) {\r\n      console.log('sss');\r\n      watcher.evaluate();\r\n    }\r\n    if (Dep.target) {\r\n      watcher.depend();\r\n    }\r\n    return watcher.value;\r\n  }\r\n}","import { compileToFunction } from \"./compile/index\";\r\nimport { callHooks, mountComponent } from \"./lifecycle\";\r\nimport Watcher from \"./observe/watcher\";\r\nimport initStates from \"./state\";\r\nimport mergeOption from \"./util/mergeOptions\";\r\n\r\nexport default initMixin;\r\n\r\nfunction initMixin(Vue) {\r\n  Vue.prototype._init = function(options) {\r\n    const vm = this;  //将当前的this对象--Vue实例  赋值给vm\r\n    vm.$options = options || {};  //新增$options属性，\r\n    console.log('options', vm.constructor.options);\r\n    vm.$options = mergeOption(vm.constructor.options, options);\r\n\r\n    callHooks(vm, 'beforeCreate');\r\n    initStates(vm); //初始化状态，包括props methods data computed watch等属性\r\n    callHooks(vm, 'created');\r\n    \r\n    //编译模板\r\n    if (options.el) {\r\n      this.$mount(options.el);\r\n    }\r\n  }\r\n\r\n  Vue.prototype.$mount = function(el) {\r\n    const vm = this;\r\n    const options = vm.$options;\r\n    if (!options.render) {\r\n      //render的优先级比el高\r\n      el = document.querySelector(el);\r\n      vm.$el = el;\r\n      let template = options.template;\r\n      if(!template && el) {\r\n        template = el.outerHTML;\r\n      }\r\n      options.render = compileToFunction(template);\r\n    }\r\n\r\n    mountComponent(vm, el);\r\n  }\r\n\r\n  Vue.prototype.$watch = function(name, handler, options = {}) {\r\n    //这里开始new Watcher  这里需要标识是用户watcher，表示是用户自己创建的watcher\r\n    options.user = true;\r\n    new Watcher(this, name, handler, options);\r\n  }\r\n}","import { isReservedTag, isObject } from \"../utils\";\r\n\r\nexport function createElement(vm, tag, data = {}, ...children) {\r\n  //这里的tag有可能是组件，所以需要先判断是否是原生标签还是组件\r\n  if (isReservedTag(tag)) {\r\n    //如果是原生标签，则直接生成真实dom\r\n    return vnode(vm, tag, data, data.key, children, undefined);\r\n  } else {\r\n    //如果是组件，拿到组件定义，生成对象\r\n    const Ctor = vm.$options.components[tag];\r\n    return createComponent(vm, tag, data, data.key, children, Ctor);\r\n  }\r\n}\r\n\r\nexport function createTextElement(vm, text) {\r\n  return vnode(vm, undefined, undefined, undefined, undefined, text, undefined);\r\n}\r\n\r\n//创建组件的虚拟dom\r\nfunction createComponent(vm, tagName, data, key, children, Ctor) {\r\n  if (isObject(Ctor)) {\r\n    Ctor = vm.$options.base.extends(Ctor);\r\n  }\r\n  data.hook = {\r\n    init(vnode) {\r\n      let vm = vnode.componentInstance = new Ctor({_isComponent: true});\r\n      vm.$mount();\r\n    }\r\n  }\r\n  //组件是没有孩子与文本的\r\n  return vnode(vm, `vue-component-${tagName}`, data, key, undefined, undefined, {Ctor, children});\r\n}\r\n\r\nfunction vnode(vm, tag, data, key, children, text, Ctor) {\r\n  return {\r\n    vm,\r\n    tag,\r\n    data,\r\n    key,\r\n    children,\r\n    text\r\n  }\r\n}","import { createElement, createTextElement } from \"./vdom/index.js\";\r\n\r\nexport function initRenderMixin(Vue) {\r\n  Vue.prototype._render = function(vm) {\r\n    let vnode = vm.$options.render.call(vm);\r\n    return vnode;\r\n  }\r\n\r\n  Vue.prototype._c = function() {\r\n    return createElement(this, ...arguments);\r\n  }\r\n\r\n  Vue.prototype._v = function(text) {\r\n    return createTextElement(this, text);\r\n  }\r\n\r\n  Vue.prototype._s = function(value) {\r\n    return typeof value === 'object' ? JSON.stringify(value) : value;\r\n  }\r\n}","import { initGlobalMethods } from \"./global.js\";\r\nimport initMixin from \"./initMixin.js\";\r\nimport { lifecycleMixin } from \"./lifecycle.js\";\r\nimport { initRenderMixin } from \"./render.js\";\r\n\r\nfunction Vue(options) {\r\n  this._init(options);\r\n}\r\ninitMixin(Vue);\r\ninitRenderMixin(Vue);\r\nlifecycleMixin(Vue);\r\n\r\ninitGlobalMethods(Vue);\r\n\r\nexport default Vue;"],"names":["cbs","waiting","timer","cb","Promise","resolve","then","flushCallbacks","forEach","nextTick","push","isObject","val","mergeHook","first","last","concat","tactics","lifeCycleHooks","lifeCycle","components","parentV","childV","options","Object","create","key","mergeOption","parent","child","parentKeys","keys","childKeys","parentKey","mergeField","childKey","hasOwnProperty","initGlobalMethods","Vue","mixin","_base","component","name","define","Super","Sub","VueComponent","_init","prototype","constructor","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","parseHtml","html","createElement","tagName","attrs","tag","children","type","text","parseStartTag","mMatch","match","advance","length","attr","end","value","substring","stack","root","start","element","pop","Error","chars","replace","textEnd","indexOf","startTagMatch","endTagMatch","defaultTagRE","generate","getChildStr","str","getAttrStr","map","gen","join","test","strs","lastIndex","exec","index","JSON","stringify","slice","trim","attrsStrs","item","styleObj","arguments","compileToFunction","template","ast","code","render","Function","uid","Dep","watchers","target","addDep","watcher","update","pushTarget","popTarget","pending","ids","queue","flushSchedule","run","queueWatchers","id","includes","Watcher","vm","updateOrFn","afterUpdate","user","lazy","dirty","getter","names","split","reduce","preV","curV","deps","depIds","undefined","get","newValue","call","dep","depId","addWatcher","i","depend","oldValue","patch","oldVnode","vnode","nodeType","ele","parentElm","parentNode","insertBefore","nextSibling","removeChild","data","createComponent","componentInstance","$el","el","document","appendChild","createTextNode","hook","init","mountComponent","updateComponent","_update","_render","callHooks","console","log","lifecycleMixin","hookName","hookCbs","$options","hookCb","isFunction","obj","isArray","Array","isReservedTag","reservedTag","oldArrayMethods","arrayMethods","methods","method","args","ob","__ob__","insertItems","observeArray","notify","observe","Observe","defineProperty","enumerable","__proto__","walk","defineReactive","dependArray","lengrh","current","childOb","set","initStates","initData","computed","initComputed","watch","initWatch","proxy","source","_data","watchs","handler","createWatch","$watch","computeds","watcherMap","_computedWatcherMap","userDef","createComputed","proxyComputed","shareProperty","createComputedGetter","computedGetter","evaluate","initMixin","$mount","querySelector","outerHTML","Ctor","createTextElement","base","_isComponent","initRenderMixin","_c","_v","_s"],"mappings":"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"}